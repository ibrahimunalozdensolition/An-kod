{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","../../../../lib/context/AuthContext.tsx"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","\"use client\";\n\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport { \n  User as FirebaseUser,\n  onAuthStateChanged,\n  signInWithEmailAndPassword,\n  createUserWithEmailAndPassword,\n  signOut as firebaseSignOut,\n  sendEmailVerification,\n} from 'firebase/auth';\nimport { doc, getDoc, setDoc, serverTimestamp } from 'firebase/firestore';\nimport { auth, db } from '@/lib/firebase/config';\nimport { User, AuthState, UserRole } from '@/lib/types/user';\n\ninterface AuthContextType extends AuthState {\n  signIn: (email: string, password: string) => Promise<void>;\n  signUp: (email: string, password: string, phoneNumber: string) => Promise<void>;\n  signOut: () => Promise<void>;\n  refreshUser: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  const fetchUserData = async (firebaseUser: FirebaseUser): Promise<User | null> => {\n    try {\n      const userDoc = await getDoc(doc(db, 'users', firebaseUser.uid));\n      \n      if (!userDoc.exists()) {\n        return null;\n      }\n\n      const userData = userDoc.data();\n      return {\n        uid: firebaseUser.uid,\n        email: firebaseUser.email!,\n        phoneNumber: userData.phoneNumber || '',\n        phoneVerified: userData.phoneVerified || false,\n        role: userData.role || 'customer',\n        createdAt: userData.createdAt?.toDate() || new Date(),\n        updatedAt: userData.updatedAt?.toDate() || new Date(),\n      };\n    } catch (error) {\n      console.error('Error fetching user data:', error);\n      return null;\n    }\n  };\n\n  const refreshUser = async () => {\n    if (auth.currentUser) {\n      const userData = await fetchUserData(auth.currentUser);\n      setUser(userData);\n    }\n  };\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\n      if (firebaseUser) {\n        const userData = await fetchUserData(firebaseUser);\n        setUser(userData);\n      } else {\n        setUser(null);\n      }\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  const signIn = async (email: string, password: string) => {\n    await signInWithEmailAndPassword(auth, email, password);\n  };\n\n  const signUp = async (email: string, password: string, phoneNumber: string) => {\n    const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n    const firebaseUser = userCredential.user;\n\n    await setDoc(doc(db, 'users', firebaseUser.uid), {\n      email: firebaseUser.email,\n      phoneNumber: phoneNumber,\n      phoneVerified: false,\n      role: 'customer' as UserRole,\n      createdAt: serverTimestamp(),\n      updatedAt: serverTimestamp(),\n    });\n\n    await sendEmailVerification(firebaseUser);\n  };\n\n  const signOut = async () => {\n    await firebaseSignOut(auth);\n  };\n\n  const value: AuthContextType = {\n    user,\n    loading,\n    signIn,\n    signUp,\n    signOut,\n    refreshUser,\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","ReactJsxRuntime","React"],"mappings":"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","ignoreList":[0,1,2]}