{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ibrahimunal/Projects/ANIKOD/lib/validations/auth.ts"],"sourcesContent":["import { z } from 'zod';\n\nexport const signUpSchema = z.object({\n  email: z.string().email('Geçerli bir e-posta adresi giriniz'),\n  password: z.string().min(6, 'Şifre en az 6 karakter olmalıdır'),\n  confirmPassword: z.string(),\n  phoneNumber: z.string().regex(/^(\\+90|0)?[0-9]{10}$/, 'Geçerli bir telefon numarası giriniz'),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: 'Şifreler eşleşmiyor',\n  path: ['confirmPassword'],\n});\n\nexport const signInSchema = z.object({\n  email: z.string().email('Geçerli bir e-posta adresi giriniz'),\n  password: z.string().min(1, 'Şifre giriniz'),\n});\n\nexport const phoneVerificationSchema = z.object({\n  code: z.string().length(6, 'Doğrulama kodu 6 haneli olmalıdır'),\n});\n\nexport type SignUpFormData = z.infer<typeof signUpSchema>;\nexport type SignInFormData = z.infer<typeof signInSchema>;\nexport type PhoneVerificationFormData = z.infer<typeof phoneVerificationSchema>;\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,MAAM,eAAe,qLAAC,CAAC,MAAM,CAAC;IACnC,OAAO,qLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,qLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,iBAAiB,qLAAC,CAAC,MAAM;IACzB,aAAa,qLAAC,CAAC,MAAM,GAAG,KAAK,CAAC,wBAAwB;AACxD,GAAG,MAAM,CAAC,CAAC,OAAS,KAAK,QAAQ,KAAK,KAAK,eAAe,EAAE;IAC1D,SAAS;IACT,MAAM;QAAC;KAAkB;AAC3B;AAEO,MAAM,eAAe,qLAAC,CAAC,MAAM,CAAC;IACnC,OAAO,qLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,qLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAC9B;AAEO,MAAM,0BAA0B,qLAAC,CAAC,MAAM,CAAC;IAC9C,MAAM,qLAAC,CAAC,MAAM,GAAG,MAAM,CAAC,GAAG;AAC7B"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Users/ibrahimunal/Projects/ANIKOD/app/auth/verify-phone/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { RecaptchaVerifier, signInWithPhoneNumber, PhoneAuthProvider, linkWithCredential } from \"firebase/auth\";\nimport { doc, updateDoc } from \"firebase/firestore\";\nimport { auth, db } from \"@/lib/firebase/config\";\nimport { useAuth } from \"@/lib/context/AuthContext\";\nimport { phoneVerificationSchema, PhoneVerificationFormData } from \"@/lib/validations/auth\";\n\ndeclare global {\n  interface Window {\n    recaptchaVerifier: RecaptchaVerifier;\n    confirmationResult: any;\n  }\n}\n\nexport default function VerifyPhonePage() {\n  const router = useRouter();\n  const { user, refreshUser } = useAuth();\n  const [error, setError] = useState<string>(\"\");\n  const [loading, setLoading] = useState(false);\n  const [codeSent, setCodeSent] = useState(false);\n  const [resendTimer, setResendTimer] = useState(60);\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<PhoneVerificationFormData>({\n    resolver: zodResolver(phoneVerificationSchema),\n  });\n\n  useEffect(() => {\n    if (!user) {\n      router.push(\"/auth/login\");\n      return;\n    }\n\n    if (user.phoneVerified) {\n      router.push(\"/dashboard\");\n      return;\n    }\n\n    setupRecaptcha();\n  }, [user, router]);\n\n  useEffect(() => {\n    if (codeSent && resendTimer > 0) {\n      const timer = setTimeout(() => setResendTimer(resendTimer - 1), 1000);\n      return () => clearTimeout(timer);\n    }\n  }, [codeSent, resendTimer]);\n\n  const setupRecaptcha = () => {\n    if (!window.recaptchaVerifier) {\n      window.recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', {\n        size: 'invisible',\n        callback: () => {\n          console.log('reCAPTCHA solved');\n        },\n      });\n    }\n  };\n\n  const sendVerificationCode = async () => {\n    if (!user) return;\n\n    try {\n      setError(\"\");\n      setLoading(true);\n      \n      const appVerifier = window.recaptchaVerifier;\n      const confirmationResult = await signInWithPhoneNumber(auth, user.phoneNumber, appVerifier);\n      window.confirmationResult = confirmationResult;\n      \n      setCodeSent(true);\n      setResendTimer(60);\n    } catch (err: any) {\n      console.error(err);\n      setError(\"Doğrulama kodu gönderilirken bir hata oluştu. Lütfen tekrar deneyin.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const onSubmit = async (data: PhoneVerificationFormData) => {\n    if (!user) return;\n\n    try {\n      setError(\"\");\n      setLoading(true);\n\n      const result = await window.confirmationResult.confirm(data.code);\n\n      await updateDoc(doc(db, 'users', user.uid), {\n        phoneVerified: true,\n        updatedAt: new Date(),\n      });\n\n      await refreshUser();\n      router.push(\"/dashboard\");\n    } catch (err: any) {\n      console.error(err);\n      if (err.code === \"auth/invalid-verification-code\") {\n        setError(\"Doğrulama kodu hatalı\");\n      } else {\n        setError(\"Doğrulama sırasında bir hata oluştu. Lütfen tekrar deneyin.\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!user) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-[#fbfbfd] px-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"mb-8 text-center\">\n          <h1 className=\"text-[32px] font-semibold text-[#1d1d1f]\">Telefon Doğrulama</h1>\n          <p className=\"mt-2 text-[17px] text-[#6e6e73]\">\n            {user.phoneNumber} numarasına gönderilen kodu giriniz\n          </p>\n        </div>\n\n        <div className=\"rounded-2xl bg-white p-8 shadow-sm\">\n          {error && (\n            <div className=\"mb-6 rounded-lg bg-red-50 p-4 text-[14px] text-red-600\">\n              {error}\n            </div>\n          )}\n\n          {!codeSent ? (\n            <div className=\"space-y-5\">\n              <p className=\"text-[14px] text-[#6e6e73]\">\n                Telefon numaranızı doğrulamak için SMS ile bir kod göndereceğiz.\n              </p>\n              <button\n                onClick={sendVerificationCode}\n                disabled={loading}\n                className=\"w-full rounded-full bg-[#0071e3] py-3 text-[17px] font-medium text-white transition-colors hover:bg-[#0077ed] disabled:opacity-50\"\n              >\n                {loading ? \"Gönderiliyor...\" : \"Doğrulama Kodu Gönder\"}\n              </button>\n            </div>\n          ) : (\n            <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-5\">\n              <div>\n                <label htmlFor=\"code\" className=\"mb-2 block text-[14px] font-medium text-[#1d1d1f]\">\n                  Doğrulama Kodu\n                </label>\n                <input\n                  {...register(\"code\")}\n                  type=\"text\"\n                  id=\"code\"\n                  maxLength={6}\n                  className=\"w-full rounded-lg border border-[#d2d2d7] px-4 py-3 text-center text-[24px] tracking-widest outline-none transition-colors focus:border-[#0071e3] focus:ring-1 focus:ring-[#0071e3]\"\n                  placeholder=\"000000\"\n                />\n                {errors.code && (\n                  <p className=\"mt-1 text-[12px] text-red-600\">{errors.code.message}</p>\n                )}\n              </div>\n\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"w-full rounded-full bg-[#0071e3] py-3 text-[17px] font-medium text-white transition-colors hover:bg-[#0077ed] disabled:opacity-50\"\n              >\n                {loading ? \"Doğrulanıyor...\" : \"Doğrula\"}\n              </button>\n\n              {resendTimer > 0 ? (\n                <p className=\"text-center text-[14px] text-[#6e6e73]\">\n                  Yeni kod gönderebilmek için {resendTimer} saniye bekleyin\n                </p>\n              ) : (\n                <button\n                  type=\"button\"\n                  onClick={sendVerificationCode}\n                  className=\"w-full text-[14px] text-[#0071e3] hover:underline\"\n                >\n                  Kodu Tekrar Gönder\n                </button>\n              )}\n            </form>\n          )}\n        </div>\n\n        <div id=\"recaptcha-container\"></div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}